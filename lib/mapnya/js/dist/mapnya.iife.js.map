{"version":3,"file":"mapnya.iife.js","sources":["../es6/tools.js","../es6/components/scale.js","../es6/components/axis.js","../es6/main.js"],"sourcesContent":["var Tools = {\n    STL: Nyaplot.STL,\n    _: Nyaplot._,\n    uuid: Nyaplot.uuid,\n    Manager: Nyaplot.Manager\n};\n\nexport default Tools;\n","import Tools from '../tools';\nvar _ = Tools._;\n\nfunction scale(domains, ranges, _options) {\n    var width = Math.abs(ranges.x[1] - ranges.x[0]);\n    var height = Math.abs(ranges.y[1] - ranges.y[0]);\n    this.offset = {\n        x: 0,\n        y: 0\n    };\n    this.scale = 1;\n    return this;\n}\n\nscale.prototype.init = function(projection) {\n    this.projection = projection;\n};\n\nscale.prototype.get = function(longitude, latitude) {\n    var point = this.projection([longitude, latitude]);\n    return {\n        x: point[0] * this.scale + this.offset.x,\n        y: point[1] * this.scale + this.offset.y\n    };\n};\n\nscale.prototype.setTranslate = function(x, y) {\n    this.offset.x = x;\n    this.offset.y = y;\n};\n\nscale.prototype.setScale = function(scale) {\n    this.scale = scale;\n};\n\nexport default scale;\n","import Tools from '../tools';\n\nfunction Axis(parent, scales, _options) {\n    var _ = Tools._;\n    var Manager = Tools.Manager;\n\n    var options = {\n        width: 0,\n        height: 0,\n        margin: {\n            top: 0,\n            bottom: 0,\n            left: 0,\n            right: 0\n        },\n        x_label: 'X',\n        y_label: 'Y',\n        zoom: true,\n        zoom_range: [0, 500],\n        rotate_x_label: 0,\n        rotate_y_label: 0,\n        pane_uuid: null,\n        z_index: 0,\n        extra: {}\n    };\n\n    var options_extra = {\n        df_id: null,\n        map_data: null,\n        cca3: null,\n        fill_by: null,\n        color: [\"none\"],\n        text_color: '#fff',\n        text_size: '1em',\n        stroke_color: '#000',\n        no_data_color: 'none',\n        center: [13, 35],\n        scale: 1000\n    };\n\n    if (arguments.length > 2) {\n        _.extend(options, _options);\n        _.extend(options_extra, _options.extra);\n        options.extra = options_extra;\n    }\n\n    var fill_scale = (function() {\n        var country_id = _.map(options.extra.map_data.features, function(d) {\n            return d.properties.iso_a3;\n        });\n\n        if (_.every(country_id, function(id) {\n                return typeof id == \"undefined\";\n            })) {\n            return d3.scale.ordinal().range(options.extra.color);\n        }\n\n        if (options.extra.fill_by != null) {\n            var df = Manager.getData(options.extra.df_id);\n            var scale = df.scale(options.extra.fill_by, options.extra.color);\n            var fill_by_column = df.column(options.extra.fill_by);\n            var id_column = df.column(options.extra.cca3);\n            return d3.scale.ordinal()\n                .domain(country_id)\n                .range(_.map(country_id, function(id, i) {\n                    var pos = id_column.indexOf(id);\n                    if (pos != -1) return scale(fill_by_column[pos]);\n                    else return options.extra.no_data_color;\n                }));\n        } else {\n            return d3.scale.ordinal()\n                .domain(country_id)\n                .range(options.extra.color);\n        }\n    })();\n\n    var model = parent.append(\"g\");\n    var clip_id = \"clip\" + options.pane_uuid;\n\n    model.append(\"clipPath\")\n        .attr(\"id\", clip_id)\n        .append(\"rect\")\n        .attr({\n            \"x\": 0,\n            \"y\": 0,\n            \"width\": options.width,\n            \"height\": options.height\n        });\n\n    model\n        .attr(\"clip-path\", \"url(#\" + clip_id + \")\")\n        .append(\"g\").attr(\"class\", \"map\")\n        .style(\"z-index\", options.z_index);\n\n    var projection = d3.geo.mercator()\n        .center(options.extra.center)\n        .scale(options.extra.scale);\n\n    scales.init(projection);\n\n    var path = d3.geo.path().projection(projection);\n\n    var graticule = d3.geo.graticule();\n    model.select(\".map\").append(\"path\")\n        .datum(graticule)\n        .attr({\n            \"d\": path,\n            \"stroke\": \"#fff\",\n            \"stroke-width\": 2\n        });\n\n    var map = model.select(\".map\").selectAll(\"path\")\n        .data(options.extra.map_data.features)\n        .enter()\n        .append('path')\n        .attr(\"d\", path)\n        .attr(\"stroke\", options.extra.stroke_color)\n        .attr(\"fill\", function(d) {\n            if (typeof d.properties.iso_a3 == \"undefined\") return options.extra.no_data_color;\n            else return fill_scale(d.properties.iso_a3);\n        });\n\n    if (options.zoom) {\n        parent.call(\n            d3.behavior.zoom()\n            .scaleExtent(options.zoom_range)\n            .on(\"zoom\", function() {\n                var translate = d3.event.translate;\n                var scale = d3.event.scale;\n                scales.setTranslate(translate[0], translate[1]);\n                scales.setScale(scale);\n                parent.select(\".context_child\").attr('transform', 'translate(' + translate + ') scale(' + scale + ')');\n                model.select(\".map\").attr('transform', 'translate(' + translate + ') scale(' + scale + ')');\n            })\n        );\n    }\n}\nexport default Axis;\n","import scale from './components/scale';\nimport axis from './components/axis';\nvar Mapnya = {};\nMapnya.Nya = {\n    'scale': scale,\n    'axis': axis\n};\n\nexport default Mapnya;\n"],"names":["axis"],"mappings":"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"}